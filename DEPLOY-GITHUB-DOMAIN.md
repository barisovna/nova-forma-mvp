# GitHub + Vercel + web-alchemy.ru (пошагово)

## 1) Репозиторий GitHub

Репозиторий уже создан и подключен:
1. `https://github.com/barisovna/nova-forma-mvp`
2. Ветка: `main`

## 2) Что должно быть в репозитории

Основные папки/файлы:
1. `public/`
2. `src/`
3. `api/`
4. `scripts/`
5. `.github/workflows/`
6. `package.json`
7. `app.js`
8. `server.js`
9. `vercel.json`
10. `.env.example`

Не хранить в репозитории:
1. реальные `.env` с ключами
2. `.vercel/`
3. runtime БД (`data/db.json`)

## 3) Vercel

Проект подключен:
1. `nova-forma-mvp`
2. Production deployment есть и зеленый.

Проверьте в Vercel -> Project -> `Settings` -> `Domains`, что есть оба домена:
1. `web-alchemy.ru`
2. `www.web-alchemy.ru`

## 4) REG.RU DNS (правильная конфигурация)

Важно: настраивать надо в **Ресурсные записи (A/CNAME)**, не в “Свой список DNS-серверов”.

Должно быть:
1. `A`:
   - Host: `@`
   - Value: `76.76.21.21`
2. `CNAME`:
   - Host: `www`
   - Value: `cname.vercel-dns.com`

## 5) Ошибки из ваших скриншотов и как исправить

### Ошибка 1: конфликт при создании CNAME для `www`

Текст ошибки:
1. `Существующая запись 'www.web-alchemy.ru. AAAA ...' конфликтует ...`

Причина:
1. Для `www` уже существует `AAAA` запись.
2. Нельзя иметь `CNAME` и `A/AAAA` одновременно на одном и том же имени.

Что сделать:
1. Удалить все записи с именем `www`, которые не CNAME (`A`, `AAAA`).
2. Оставить только:
   - `www CNAME cname.vercel-dns.com`

### Ошибка 2: открывается страница REG.RU “Сайт размещен некорректно”

Причина:
1. Браузер/провайдер кэширует старые DNS.
2. Раньше `www` указывал на хостинг REG.RU.

Что сделать:
1. В Windows:
```powershell
ipconfig /flushdns
```
2. Закрыть все вкладки домена и открыть в режиме InPrivate/Incognito.
3. Проверить DNS вручную:
```powershell
nslookup -type=A web-alchemy.ru 1.1.1.1
nslookup -type=CNAME www.web-alchemy.ru 1.1.1.1
```
Ожидаемо:
1. `web-alchemy.ru -> 76.76.21.21`
2. `www.web-alchemy.ru -> cname.vercel-dns.com`

## 6) Текущее состояние по проверке из терминала

Проверено локально:
1. `web-alchemy.ru` резолвится в `76.76.21.21`.
2. `www.web-alchemy.ru` резолвится в `cname.vercel-dns.com`.

Это означает, что DNS уже близок к корректному состоянию, осталось дождаться кэша в браузере/провайдере.

## 7) Финальная проверка после кэша

Проверьте:
1. `https://web-alchemy.ru`
2. `https://www.web-alchemy.ru`
3. `https://web-alchemy.ru/api/health`

Если домен открывается, но показывает старую страницу:
1. откройте из другого браузера;
2. откройте с телефона через мобильный интернет;
3. подождите 30-120 минут (иногда до 24 часов).

## 8) Что значит "Не заслуживающий доверия ответ" в nslookup

Это нормально.

В `nslookup` фраза "Не заслуживающий доверия ответ" означает:
1. ответ пришел не от авторитативного DNS вашего домена;
2. это кэшированный/рекурсивный ответ (например, от `1.1.1.1`).

Если значения в ответе правильные (`A` и `CNAME`), DNS работает корректно.

## 9) Что значит "DNS Change Recommended" в Vercel

Это рекомендация, а не критическая ошибка.

Vercel сейчас рекомендует новые значения:
1. `A @ -> 216.198.79.1`
2. `CNAME www -> ...vercel-dns-017.com`

Старые значения (`76.76.21.21` и `cname.vercel-dns.com`) тоже рабочие.

Если хотите убрать предупреждение в Vercel:
1. обновите записи в REG.RU на рекомендованные;
2. нажмите `Refresh` в Vercel -> Domains.
